#. 并发安全
1. 类的线程安全定义: 如果多线程下使用这个类, 不管多线程如何使用和调度这个类, 这个类总是表示出正确的行为, 这个类就是线程安全的.
2. 操作的原子性 内存的可见性.
3. 会在多个线程之间共享状态的时候, 就会出现线程不安全.
4. 怎么才能做到类的线程安全?, (除此都可以认为是线程不安全的)
    - 栈封闭: 所有的变量都是在方法内部声明的, 这些变量都处于栈封闭状态.
    - 无状态: 没有任何成员变量的类, 就叫无状态的类.
    - 让类不可变: 让状态不可变,
        - 1. 加final关键字.对于一个类来讲所有的成员变量应该是私有的, 同样的只要有可能: 所有的成员变量应该加上final.
        - 2. 根本就不提供任何可供修改成员变量的地方, 同时成员变量也不作为方法的返回值.
    - volatile: 保证类的可见性, 最适合一个线程写, 多个线程读的情景.
    - 加锁和CAS:
    - 安全的发布: return时不不返回对象.
        - 要么用线程安全的容器替换
        - 要么发布出去的时候,提供副本, 深度拷贝.
    - ThreadLocal: 多个成员变量.
5. Servlet不是线程安全的类,但是没有感觉到是线程不安全的,是因为
    - 1. 很少有共享的需求
    - 2. web容器接收到了请求, 返回应答的时候,都是由一个线程来负责的,所以谈不上并发